
 ## 토큰

 

- 서버에서 클라이언트를 구분하기 위한 유일한 값
- 서버가 토큰을 생성해서 클라이언트에게 제공
- 클라이언트는 요청을 이 토큰과 함께 보낸다
- 서버는 토큰만 보고 유효한 사용자인지 검증한다

> 토큰은 요청과 응답에 함께 보낸다
> 

 
 ## 토큰 기반 인증의 특징

 

1. 무상태성
    - 클라이언트가 관리하기에 서버에 저장할 필요가 없다
    
2. 확장성
    - 서버에 저장하지 않으므로 상태 관리를 할 필요가 없다
    - 서버 확장에 용이하다
    
3. 무결성
    - 토큰을 발급하면 토큰 정보를 변경하는 행위를 할 수 없다
        - 한 글자라도 변경되면 서버에서는 유효하지 않은 토큰이라고 판단
    - 토큰 방식 == HMAC (=Hash-based Message Authentication)
    - 토큰의 무결성이 보장된다
    

 
 ## JWT (=Json Web Token)

 

> JWT는 .을 기준으로 헤더(header), 내용(payload), 서명(signature)으로 이루어져 있다
> 

ex) hhh.ppp.sss

> 헤더
> 
- 토큰의 타입과 해싱 알고리즘을 지정하는 정보를 담는다

```json
헤더 내용
{
	"typ":"JWT", //토큰 타입 -> JWT 타입
	"alg":"HS256" //해싱 알고리즘 -> HS256 방식으로 암호화
}
```

> 내용
> 
- 토큰과 관련된 정보를 담는다
- 덩어리 하나 당 클레임 (=claim)이라고 부른다

> 등록된 클레임
> 
- iss : 토큰 발급자 isuuer
- sub : 토큰 제목 subject
- aud : 토큰 대상자 audience
- exp : 토큰 만료 시간 expiration
- nbf : 토큰의 활성 날짜 not before
- iat : 토큰 발급 시간 issued at
- jti : JWT 고유 식별자, 주로 일회용 토큰에서 사용

> 공개 클레임 : 공개 되어도 상관 없는 클레임
> 
- 충돌을 방지할 수 있는 이름을 가져야 한다
- 보통 이름을 URL로 짓는다

> 비공개 클레임
> 
- 공개 되면 안 되는 클레임 : 클라이언트와 서버 간의 통신에서 사용한다

 
 ## 서명

 

- 해당 토큰이 조작 되었는지 확인하기 위해 사용
- 헤더의 인코딩 값과 내용의 인코딩 값을 합친 뒤 비밀 키를 이용해 해시 값을 생성한다

 
 ## 리프레시 토큰

 

- 액세스 토큰과 별개의 토큰
- 액세스 토큰이 만료되었을 경우 새로운 액세스 토큰 발급을 위해 사용하는 토큰
